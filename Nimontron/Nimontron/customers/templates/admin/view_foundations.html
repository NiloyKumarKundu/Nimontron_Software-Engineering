<!DOCTYPE html>
<html>
<body style="background-color:#19595E">
{% include 'admin/admin_navbar.html' %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>


<div id="details"></div>




<div class="modal bd-example-modal-lg fade" id="viewModal">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="name">Name</h4>
                <button class="close" data-dismiss="modal">&times;</button>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div>
                            <img id="img" src="" style="height: auto; width: 100%;" alt="">
                        </div>  
                    </div>
                    <div class="col-md-6">
                        <p id="postId" hidden></p>
                        <p id="description">Description:</p>
                        <p id="address">Address: </p>
                        <p id="contact_no">Contact No: </p>
                        <p id="code_no">Code No: </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>







<script>
function getData () {
    let xmlhttp = new XMLHttpRequest();

    fetch('http://127.0.0.1:8000/all_foundation_jsn')
    .then(response => response.json()).then(myObj => {
            let doc = document.querySelector("#details");
            console.log(myObj);

        

            let  tag1 = " <table class='table table-hover container' style='color:white;'>";
            tag1 += "<thead>";
            tag1 += "<tr>";
            tag1 += "<th> Sr.no </th>";
            tag1 += "<th> Name </th>";
            tag1 += "<th> Contact_no </th>";
            tag1 += "<th> Address </th>";
            tag1 += "</tr>";
            tag1 += "</thead>";
            tag1 += "<tbody>";

            let size = myObj.content.length;

            for (let i = 0; i < size; i++) {
                tag1 += "<tr>";

                tag1 += "<td>";
                tag1 += i + 1;
                tag1 += "</td>";

                tag1 += "<td>";
                tag1 += JSON.parse(JSON.stringify(myObj.content[i].name));
                tag1 += "</td>";

                tag1 += "<td>";
                tag1 += JSON.parse(JSON.stringify(myObj.content[i].contact_no));
                tag1 += "</td>";

                tag1 += "<td>";
                tag1 += JSON.parse(JSON.stringify(myObj.content[i].address));
                tag1 += "</td>";

                tag1 += "<td>";
                tag1 += "<a href='#' onclick='submit_edit( + " + JSON.stringify(myObj.content[i].id) + ")' data-target='#mymodel'  data-toggle='modal' class='btn btn-success btn-sm'>Edit</a>";
                tag1 += "</td>";

                tag1 += "<td>";
                tag1 += "<a href='#' onclick='submit_view( + " + JSON.stringify(myObj.content[i].id) + ")' data-target='#viewModal'  data-toggle='modal' class='btn btn-info btn-sm'>View</a>";
                tag1 += "</td>";

                tag1 += "<td>";
                tag1 += "<a onclick='submit_delete( + " + JSON.stringify(myObj.content[i].id) + ")' class='btn btn-danger btn-sm delete'>Delete</a>";
                tag1 += "</td>";

                tag1 += "</tr>";
            }
            tag1 += "</tbody>";
            tag1 += "</table></div>";
            doc.innerHTML = tag1;
    })
};





document.addEventListener("DOMContentLoaded", function() {
    getData();
});


function submit_delete(id) {
    fetch('http://127.0.0.1:8000/foundation_delete/' + id)
    .then(response => response.json()).then(myObj => {
        alert("Item has been deleted successfully!");
        getData();
    })
};


function submit_edit(id) {
    const form = document.getElementById("content_form");
    let form_id = document.querySelector("#form_id");
    let title = document.querySelector("#title");
    let description = document.querySelector("#description");
    let end_date = document.querySelector("#end_date");
    let quantity = document.querySelector("#quantity");
    let area = document.querySelector("#area");
    let contact = document.querySelector("#contact");
    
    fetch('http://127.0.0.1:8000/api/customer_specific_donate_post/' + id)
    .then(response => response.json()).then(myObj => {
        form_id.value = JSON.parse(JSON.stringify(myObj['content'][0]['id']));

        let value = JSON.parse(JSON.stringify(myObj['content'][0]['title']));
        title.value = value;

        value = JSON.parse(JSON.stringify(myObj['content'][0]['description']));
        description.value = value;

        value = JSON.parse(JSON.stringify(myObj['content'][0]['end_date']));
        end_date.value = value;

        value = JSON.parse(JSON.stringify(myObj['content'][0]['quantity']));
        quantity.value = value;

        value = JSON.parse(JSON.stringify(myObj['content'][0]['area']));
        area.value = value;

        value = JSON.parse(JSON.stringify(myObj['content'][0]['contact']));
        contact.value = value;
    })
} 


function submitForm(form) {
    let form_id = document.querySelector("#form_id").value;
    let title = document.querySelector("#title").value;
    let description = document.querySelector("#description").value;
    let end_date = document.querySelector("#end_date").value;
    let quantity = document.querySelector("#quantity").value;
    let area = document.querySelector("#area").value;
    let contact = document.querySelector("#contact").value;

    // form.submit();
    console.log(form_id, title)

    fetch('http://127.0.0.1:8000/customer_edit_s_donate_post?id=' + form_id + '&title=' + title + '&description=' + description + '&quantity=' + quantity + '&area=' + area + '&contact=' + contact + '&end_date=' + end_date)
    .then(response => response.json()).then(myObj => {
        alert("Item has been Edited successfully!");
        getData();
    })
};




function submit_view(id) {
    let img = document.querySelector('#img');
    let postId = document.querySelector('#postId');
    let name = document.querySelector('#name');
    let description = document.querySelector('#description');
    let address = document.querySelector('#address');
    let contact_no = document.querySelector('#contact_no');
    let code_no = document.querySelector('#code_no');


    fetch('http://127.0.0.1:8000/specific_foundation_view/' + id)
    .then(response => response.json()).then(myObj => {
        console.log(myObj)
        postId.innerHTML = JSON.stringify(myObj['content'][0]['id']);
        description.innerHTML = "Description: " + JSON.parse(JSON.stringify(myObj['content'][0]['description']));

        name.innerHTML = JSON.parse(JSON.stringify(myObj['content'][0]['name']));
        contact_no.innerHTML = "Contact No: " + myObj['content'][0]['contact_no'];
        address.innerHTML = "Address: " + myObj['content'][0]['address'];
        code_no.innerHTML = "Code No: " + myObj['content'][0]['code_no'];

        let x = JSON.parse(JSON.stringify(myObj['content'][0]['image']));
        console.log(x);
        img.src = "/media/" + x;
        console.log(img.src);
    });
}






</script>



</body>
</html> 

